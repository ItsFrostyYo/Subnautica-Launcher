<Window x:Class="SubnauticaLauncher.UI.SpeedrunTimerStylePlacementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="Timer Style and Placement"
        Width="740"
        Height="420"
        MinWidth="740"
        MinHeight="420"
        ResizeMode="CanResizeWithGrip"
        WindowStartupLocation="CenterScreen"
        FontFamily="{DynamicResource AppFontFamily}"
        WindowStyle="None"
        AllowsTransparency="True">

    <Window.Resources>

        <ImageBrush x:Key="BackgroundBrush"
                    Stretch="UniformToFill"/>

        <Style TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style x:Key="MutedText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#D0E7F2"/>
        </Style>

        <Style x:Key="DarkComboBox" TargetType="ComboBox" BasedOn="{StaticResource DarkComboBoxBase}">
            <Setter Property="Height" Value="35"/>
        </Style>

        <Style x:Key="HexInput" TargetType="TextBox">
            <Setter Property="Background" Value="#22000000"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontFamily" Value="Consolas"/>
        </Style>

        <Style x:Key="NumericInput" TargetType="TextBox">
            <Setter Property="Background" Value="#22000000"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="60"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

    </Window.Resources>

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            CaptionHeight="25"
            ResizeBorderThickness="6"
            CornerRadius="0"
            GlassFrameThickness="0"
            UseAeroCaptionButtons="False"/>
    </shell:WindowChrome.WindowChrome>

    <Grid>

        <Rectangle Fill="{StaticResource BackgroundBrush}">
            <Rectangle.Effect>
                <BlurEffect Radius="8"/>
            </Rectangle.Effect>
        </Rectangle>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="25"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title bar -->
            <Grid Grid.Row="0"
                  Background="{StaticResource WindowTitleBarBrush}"
                  MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Image Source="pack://application:,,,/Assets/Icons/SNLIcon.png"
                       Width="16"
                       Height="16"
                       Margin="12,0,8,0"
                       VerticalAlignment="Center"/>

                <TextBlock Grid.Column="1"
                           Text="Timer Style and Placement"
                           VerticalAlignment="Center"
                           FontSize="13"
                           Margin="0,3,0,0"
                           FontWeight="SemiBold"/>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Content="&#x2715;"
                            Width="44"
                            Height="25"
                            Background="{StaticResource DangerRedBrush}"
                            BorderBrush="{StaticResource WindowButtonBorderBrush}"
                            BorderThickness="1"
                            Click="Close_Click"
                            shell:WindowChrome.IsHitTestVisibleInChrome="True"/>
                </StackPanel>
            </Grid>

            <!-- Content: horizontal layout -->
            <Border Grid.Row="1"
                    Background="{StaticResource VersionListCardBrush}"
                    CornerRadius="14"
                    Padding="8"
                    Margin="8,4,8,6">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="280"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- LEFT: Timer Style (no scroll) -->
                    <StackPanel Grid.Column="0" Margin="0,0,8,0">
                        <TextBlock Text="Timer Style"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>

                        <TextBlock Text="Text Color" FontWeight="SemiBold" Margin="0,0,0,2"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <TextBox x:Name="TextColorInput"
                                     Style="{StaticResource HexInput}"
                                     Width="90"
                                     Text="#FFFFFF"
                                     TextChanged="TextColorInput_TextChanged"/>
                            <Border x:Name="TextColorPreview"
                                    Width="28"
                                    Height="28"
                                    CornerRadius="4"
                                    BorderBrush="#60FFFFFF"
                                    BorderThickness="1"
                                    Background="White"
                                    Margin="6,0,0,0"
                                    Cursor="Hand"
                                    MouseLeftButtonDown="TextColorPreview_MouseLeftButtonDown"/>
                        </StackPanel>

                        <CheckBox x:Name="TextOutlineCheckBox"
                                  Content="Text Outline"
                                  Foreground="White"
                                  Margin="0,0,0,2"
                                  Checked="TextOutlineCheckBox_Changed"
                                  Unchecked="TextOutlineCheckBox_Changed"/>
                        <StackPanel x:Name="OutlineOptionsPanel"
                                    Orientation="Horizontal"
                                    Visibility="Collapsed"
                                    Margin="0,0,0,4">
                            <TextBlock Text="Thickness" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox x:Name="OutlineThicknessInput"
                                     Style="{StaticResource NumericInput}"
                                     Text="1"
                                     TextChanged="OutlineThicknessInput_TextChanged"/>
                            <TextBlock Text="Color" VerticalAlignment="Center" Margin="8,0,4,0"/>
                            <TextBox x:Name="OutlineColorInput"
                                     Style="{StaticResource HexInput}"
                                     Width="70"
                                     Text="#000000"
                                     TextChanged="OutlineColorInput_TextChanged"/>
                            <Border x:Name="OutlineColorPreview"
                                    Width="24"
                                    Height="24"
                                    CornerRadius="4"
                                    BorderBrush="#60FFFFFF"
                                    BorderThickness="1"
                                    Background="Black"
                                    Margin="4,0,0,0"
                                    Cursor="Hand"
                                    MouseLeftButtonDown="OutlineColorPreview_MouseLeftButtonDown"/>
                        </StackPanel>

                        <TextBlock Text="Padding" FontWeight="SemiBold" Margin="0,0,0,2"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <TextBlock Text="H" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox x:Name="PaddingHInput"
                                     Style="{StaticResource NumericInput}"
                                     Text="10"
                                     TextChanged="PaddingHInput_TextChanged"/>
                            <TextBlock Text="V" VerticalAlignment="Center" Margin="8,0,4,0"/>
                            <TextBox x:Name="PaddingVInput"
                                     Style="{StaticResource NumericInput}"
                                     Text="6"
                                     TextChanged="PaddingVInput_TextChanged"/>
                        </StackPanel>

                        <TextBlock Text="Font Size" FontWeight="SemiBold" Margin="0,0,0,2"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <TextBox x:Name="FontSizeInput"
                                     Style="{StaticResource NumericInput}"
                                     Text="40"
                                     TextChanged="FontSizeInput_TextChanged"/>
                        </StackPanel>

                        <TextBlock Text="Background" FontWeight="SemiBold" Margin="0,0,0,2"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                            <TextBox x:Name="BgColorInput"
                                     Style="{StaticResource HexInput}"
                                     Width="70"
                                     Text="#000000"
                                     TextChanged="BgColorInput_TextChanged"/>
                            <Border x:Name="BgColorPreview"
                                    Width="24"
                                    Height="24"
                                    CornerRadius="4"
                                    BorderBrush="#60FFFFFF"
                                    BorderThickness="1"
                                    Background="Black"
                                    Margin="4,0,0,0"
                                    Cursor="Hand"
                                    MouseLeftButtonDown="BgColorPreview_MouseLeftButtonDown"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                            <TextBlock Text="Opacity" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <Slider x:Name="BgOpacitySlider"
                                    Minimum="0" Maximum="100" Value="53"
                                    Width="120" VerticalAlignment="Center"
                                    ValueChanged="BgOpacitySlider_ValueChanged"/>
                            <TextBlock x:Name="BgOpacityLabel" Text="53%" VerticalAlignment="Center" Margin="4,0,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- RIGHT: Timer Placement (preview + position + buttons, no scroll) -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left">
                        <TextBlock Text="Timer Placement"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,2"/>
                        <!-- Row 1: Preview Background + Position (1920×1080) side by side -->
                        <Grid Margin="0,0,0,2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0" Orientation="Vertical" Margin="0,0,12,0">
                                <TextBlock Text="Preview Background" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                <ComboBox x:Name="PreviewBackgroundDropdown"
                                          Style="{StaticResource DarkComboBox}"
                                          Width="200"
                                          HorizontalAlignment="Left"
                                          SelectionChanged="PreviewBackgroundDropdown_SelectionChanged"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Top">
                                <TextBlock Text="Position (1920×1080)" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                <TextBlock x:Name="PositionLabel"
                                           Text="X 1536 px,  Y 14 px"
                                           Foreground="#D0E7F2"
                                           FontFamily="Consolas"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Grid>
                        <Border BorderBrush="#60FFFFFF"
                                BorderThickness="1"
                                CornerRadius="4"
                                Background="#20000000"
                                Margin="0,0,0,2"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top">
                            <Canvas x:Name="ScreenPreviewCanvas"
                                    Width="400"
                                    Height="225"
                                    ClipToBounds="True"
                                    MouseLeftButtonDown="ScreenPreview_MouseLeftButtonDown"
                                    MouseMove="ScreenPreview_MouseMove"
                                    MouseLeftButtonUp="ScreenPreview_MouseLeftButtonUp">
                                <Rectangle x:Name="PreviewBackgroundImage"
                                           Canvas.Left="0" Canvas.Top="0"
                                           Width="400" Height="225"
                                           Stretch="Fill">
                                    <Rectangle.Effect>
                                        <BlurEffect Radius="8"/>
                                    </Rectangle.Effect>
                                </Rectangle>
                                <Border x:Name="TimerPreviewBorder"
                                        Background="#88000000"
                                        Padding="10,6"
                                        Canvas.Left="0" Canvas.Top="0"
                                        Cursor="SizeAll">
                                    <TextBlock x:Name="TimerPreviewText"
                                               Text="00:00:00.000"
                                               FontFamily="{DynamicResource AppFontFamily}"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               Foreground="White"/>
                                </Border>
                            </Canvas>
                        </Border>
                        <TextBlock Text="Drag timer to position" Style="{StaticResource MutedText}" FontSize="11" Margin="0,0,0,4"/>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                            <Button Content="Apply" Width="90" Height="30" Margin="0,0,6,0"
                                    Background="{StaticResource AccentBlueBrush}"
                                    Style="{StaticResource RoundedButton}"
                                    Click="Apply_Click"/>
                            <Button Content="Reset to Default" Width="138" Height="30" Margin="0,0,6,0"
                                    Background="{StaticResource WarningOrangeBrush}"
                                    Style="{StaticResource RoundedButton}"
                                    Click="ResetToDefault_Click"/>
                            <Button Content="Cancel" Width="72" Height="30"
                                    Background="{StaticResource DangerRedBrush}"
                                    Style="{StaticResource RoundedButton}"
                                    Click="Cancel_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
